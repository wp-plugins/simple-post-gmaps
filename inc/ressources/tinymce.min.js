(function(){jQuery(".sendSMPG select[name=post_type]").live("change",function(a){a.preventDefault();spgm_refresh_taxonomies(this)});jQuery(".sendSMPG select[name=taxonomy]").live("change",function(a){a.preventDefault();spgm_refresh_terms(this)});launched=false;tinymce.create("tinymce.plugins.spgm",{init:function(a){a.addButton("spgm",{title:"Simple Post GMaps",onclick:function(){tb_show("Simple post gmaps Shortcode",ajaxurl+"?action=spgm_shortcodePrinter&width=600&height=900");launched||jQuery("form.sendSMPG").live("submit",
function(c){launched=true;_self=this;c.preventDefault();a.execCommand("mceInsertContent",true,spgm_create_shortcode(_self));tb_remove()})}})},createControl:function(){return null},getInfo:function(){return{longname:"Simple Post Gmaps",author:"Beapi",authorurl:"http://beapi.fr/",infourl:"http://beapi.fr/",version:"1.0"}}});tinymce.PluginManager.add("spgm",tinymce.plugins.spgm)})();
function spgm_create_shortcode(a){var a=jQuery(a).serializeArray(),c=" [global-googlemaps ",b;for(b in a)if(!(a[b].value=="-1"||a[b].value=="any")){if(a[b].value=="")a[b].value=false;c+=" "+a[b].name+'="'+a[b].value+'"'}c+=" ] ";return c}function spgm_preview(a){jQuery(a).closest("form").serialize()}
function spgm_refresh_taxonomies(a){var a=jQuery(a),c=jQuery(".sendSMPG select[name=taxonomy]"),b=c.closest("td"),a=a.val();b.hasClass("ajaxing")||jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"post_type_taxonomy",post_type:a},beforeSend:function(){b.addClass("ajaxing");b.fadeTo("fast","0.5")},success:function(a){output=jQuery("<option/>").attr("value","-1").html("None");b.removeClass("ajaxing");b.fadeTo("fast","1");for(var d in a)output.push(jQuery("<option/>").attr("value",d).html(a[d])[0]);
c.html(output)}})}
function spgm_refresh_terms(a){var a=jQuery(a),c=jQuery(".sendSMPG select[name=term]"),b=c.closest("td"),a=a.val();b.hasClass("ajaxing")||jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"taxonomy_terms",taxonomy:a},beforeSend:function(){b.addClass("ajaxing");b.fadeTo("fast","0.5")},success:function(a){output=jQuery("<option/>").attr("value","-1").html("None");b.removeClass("ajaxing");b.fadeTo("fast","1");for(var d in a)output.push(jQuery("<option/>").attr("value",d).html(a[d])[0]);
c.html(output)}})};