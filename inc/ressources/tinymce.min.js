function spgm_refresh_taxonomies(a){var b=jQuery(a);var c=jQuery(".sendSMPG select[name=taxonomy]");var d=c.closest("td");var e=b.val();if(!d.hasClass("ajaxing")){jQuery.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"post_type_taxonomy",post_type:e},beforeSend:function(){d.addClass("ajaxing");d.fadeTo("fast","0.5")},success:function(a){output=jQuery("<option/>").attr("value","-1").html("None");d.removeClass("ajaxing");d.fadeTo("fast","1");for(var b in a){output.push(jQuery("<option/>").attr("value",b).html(a[b])[0])}c.html(output)}})}}function spgm_preview(a){var b=jQuery(a).closest("form").serialize()}function spgm_create_shortcode(a){var b=jQuery(a).serializeArray();var c=" [global-googlemaps ";for(var d in b){if(b[d].value=="-1"||b[d].value=="any")continue;c+=" "+b[d].name+"="+b[d].value}c+=" ] ";return c}(function(){jQuery(".sendSMPG select[name=post_type]").live("change",function(a){a.preventDefault();spgm_refresh_taxonomies(this)});var a=false;tinymce.create("tinymce.plugins.spgm",{init:function(b,c){b.addButton("spgm",{title:"Simple Post GMaps",onclick:function(){tb_show("Simple post gmaps Shortcode",ajaxurl+"?action=spgm_shortcodePrinter&width=600&height=900");if(!a){jQuery("form.sendSMPG").live("submit",function(c){a=true;_self=this;c.preventDefault();b.execCommand("mceInsertContent",true,spgm_create_shortcode(_self));tb_remove()})}}})},createControl:function(a,b){return null},getInfo:function(){return{longname:"Simple Post Gmaps",author:"Beapi",authorurl:"http://beapi.fr/",infourl:"http://beapi.fr/",version:"1.0"}}});tinymce.PluginManager.add("spgm",tinymce.plugins.spgm)})()